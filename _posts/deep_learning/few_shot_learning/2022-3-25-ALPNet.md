---
layout: post
title: ECCV 2020 ALPNet 阅读笔记
date: 2022-3-25 16:55:00 +0800
categories: 深度学习
mathjax: true
figure: /images/2022-03/ALPNet.png
author: Jiaxi
meta: Post
---

* content
{:toc}




论文题目: Self-supervision with Superpixels:Training Few-Shot Medical Image Segmentation Without Annotation

作者: Cheng Ouyang, Carlo Bi, Chen Chen, Turkay Kart, Huaqi Qiu, Daniel Rueckert

研究机构: BioMedIA Group, Department of Computing, Imperial College London, UK

时间: 2020.01.20

## 摘要
本文提出了一种用于医学图像的新型自监督 FSS 框架，Adaptive local prototype pooling模块。解决了few-shot segmentation领域中依赖大量带注释的样本以及通常使用prototype learning的网络架构中存在局部信息丢失的问题，同时解决医学图像分割中常见的具有挑战性的前景-背景不平衡问题。

## 研究背景

#### **医学图像分割领域存在问题**
* 缺少大量的专家注释
* 可能的分割目标（不同的解剖结构、不同类型的病变等）的数量是无数的。 通过训练一个新的、特定的模型来覆盖每一个看不见的类是不切实际的。

#### **Few-shot learning 能够解决上述问题**
* Few-shot学习模型在inference阶段仅从少数标记示例（Support set）中提取未见类的判别表示，以对未标记示例（Query set）进行预测，而无需重新训练模型。如果将小样本学习应用于医学图像，则可以仅使用少数标记示例就可以有效地分割罕见或新颖的病变。

#### **Few-shot 语义分割存在问题**
* 大多数Few-shot segmentation（FSS）的方法依赖于大量带注释的样本。
* 许多最先进的 FSS 网络架构学习的表示存在局部信息丢失的问题。这个问题在医学图像中尤为突出，因为医学图像中普遍存在极端的前景-背景不平衡。

<div align=center><img src="/images/2022-03/ALPNet_bg.png" width = "300" height = "200" /></div>
<center>图1: 背景类大且空间不均匀，而前景类（紫色）小且均匀。在这种情况下，如果背景中不同局部区域的不同外观信息被不合理地平均化，则可能会出现预测背景边界的模糊性。</center>


## 贡献点

* 一种用于医学图像的新型自监督 FSS 框架，以消除训练过程中对注释的需求。 此外，生成基于超像素的伪标签以提供监督；
* 插入Adaptive local prototype pooling模块，解决医学图像分割中常见的具有挑战性的前景-背景不平衡问题；
* 使用三种不同的任务证明了所提出的方法对医学图像的一般适用性：CT和MRI的腹部器官分割，以及 MRI 的心脏分割。对于医学图像分割，所提出的方法优于需要手动注释进行训练的传统FSS方法。

## 模型框架

模型包括三个部分：特征提取器、Adaptive local prototype pooling以及基于相似性的分类器。

![](/images/2022-03/ALPNet.png)

#### **Workflow**
1. 特征提取器f将support image和query image作为输入，生成对应的feature map
2. Adaptive local prototype pooling模块将Support feature map和label作为输入，以获得表示背景和前景的prototype集合。
3. 这些prototype用作与Query feature map进行相似性计算，将相似的融合在一起形成最终的分割结果。 


#### **Adaptive local prototype pooling**

1. **模块主要作用:** 保护局部信息，在 ALP 中，每个local prototype仅在覆盖在支持上的局部池窗口内计算，并且仅代表感兴趣目标的一部分。

    <div align=center><img src="/images/2022-03/ALPNet_ALP.png" width = "20%" height = "20%" /></div>

2. **local prototype的计算方法**

    * 选择feature map上 $$(L_H, L_W)$$ 进行平均池化

    <div align=center><img src="/images/2022-03/ALPNet_g1.png" /></div>

    * 为了确定每个位置是前景还是背景，对label的前景mask也进行相同范围的平均池化，当阈值T>0.95时为前景类，否则为背景：

    <div align=center><img src="/images/2022-03/ALPNet_g2.png" /></div>

    * 为了确保为小于池化窗口(LH，LW)的分割目标生成至少一个Prototype，计算一个class-level的prototype通过masked平均池化：

    <div align=center><img src="/images/2022-03/ALPNet_g3.png" /></div>
    &nbsp;&nbsp;通过将不同的局部区域明确表示为单独的prototype来保留更多的类内局部区别




